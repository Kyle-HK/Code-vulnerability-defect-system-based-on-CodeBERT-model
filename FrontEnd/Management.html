<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>漏洞检测系统</title>
  <style>
        body {
            background-image: url('back.jpeg');
	        background-size: cover;
	        backdrop-filter: blur(3px);
            }
        * {
            margin: 0;
            padding: 0;
            list-style: none;
            text-decoration: none;
            font-weight: 520;
            font-family: 微软雅黑;
        }

        #nav {
            width: 900px;
            height: 72px;
            background-color: rgb(247, 249, 250);
            border-radius: 20px;
            margin: 20px auto;
        }

        #nav>ul>li {
            float: left;
            width: 175.75px;
            height: 72px;
            text-align: center;
        }

        #nav>ul>li>a {
            text-align: center;
            line-height: 72px;
            font-size: 20px;
            color: black;
        }

        #nav>ul>li>a:hover {
            color: orange;
        }

         ul>span {
            float: left;
            line-height: 72px;
            color: rgb(225, 224, 224);
            font-weight: 800;
            font-size: 24px;
        }

       table {
            border-collapse: collapse;
            width: 100%;
            background-color: white;
        }
       th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
       }
       th {
            background-color: #f2f2f2;
       }
       .logo {
			font-family: 'Kaushan Script', cursive;
			font-size: 2rem;
			color: #fff;
			padding: 0.5rem 1rem;
			border-radius: 0.5rem;
            }
  </style>
</head>
<body>
<div class="logo">软件漏洞检测系统</div>
<div id="nav">
<ul>
  <li><a href="Intro.html" class="a1">Introduction</a></li><span>|</span>
  <li><a href="Detect.html" class="a1">Code Defect</a></li><span>|</span>
  <li><a href="defectReport.html" class="a1">Format Defect</a></li><span>|</span>
  <li><a href="Management.html" class="a1">Management</a></li><span>|</span>
  <li><a href="usermanagement.html" class="a1">Users</a></li>
</ul>
</div>
<p style="color:white">欢迎您，<span id="username"></span>！</p>
<table id="records">
  <thead>
  <tr>
    <th>检测代码</th>
    <th>检测时间</th>
    <th>检测状态</th>
  </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<script>
    // 获取用户名
    var username = localStorage.getItem('username');
    var usernameElement = document.getElementById('username');
    usernameElement.textContent = username;

    // 获取检测代码
    var code = localStorage.getItem('code');

    // 获取检测状态
    var status = localStorage.getItem('status');


    // 获取当前系统检测时间
    function getCurrentTime() {
      var now = new Date();
      return now.toLocaleString();
    }

    // 获取表格元素
    var table = document.getElementById('records');

    // 创建表格内容
    var tbody = table.getElementsByTagName('tbody')[0];
    var records = JSON.parse(localStorage.getItem('records')) || [];


    records.forEach(function(record) {
      var tr = document.createElement('tr');
      var td1 = document.createElement('td');
      var td2 = document.createElement('td');
      var td3 = document.createElement('td');
      td1.textContent = record.code;
      td2.textContent = record.time;
      td3.textContent = record.status;
      tr.appendChild(td1);
      tr.appendChild(td2);
      tr.appendChild(td3);
      tbody.appendChild(tr);
    });

    // 添加新的检测记录
    function addRecord(code, status) {
      var time = getCurrentTime();
      var record = { code: code, time: time, status: status };
      records.push(record);
      localStorage.setItem('records', JSON.stringify(records));

      // 创建新的表格行
      var tr = document.createElement('tr');
      var td1 = document.createElement('td');
      var td2 = document.createElement('td');
      var td3 = document.createElement('td');
      td1.textContent = record.code;
      td2.textContent = record.time;
      td3.textContent = record.status;
      tr.appendChild(td1);
      tr.appendChild(td2);
      tr.appendChild(td3);
      tbody.appendChild(tr);
    }

     // 检测代码
    function checkCode() {
      // 获取代码信息
      var code = localStorage.getItem('code');

      // 模拟检测过程
     var status = localStorage.getItem('status');

   // 判断是否重复
      var isDuplicate = false;
      records.forEach(function(record) {
        if (record.code === code) {
          isDuplicate = true;
        }
      });

      // 如果不重复，则添加检测记录
      if (!isDuplicate) {
        addRecord(code, status);
      }
       if (isDuplicate) {
        alert("此项记录已经添加，不可重复添加");
      }
    }
    // 清空记录
    function clearRecords() {
      localStorage.removeItem('records');
      tbody.innerHTML = '';
      localStorage.removeItem('code');
    }
</script>
<div style="display: flex; justify-content: center; align-items: center;">
<button onclick="checkCode()">查询记录</button>
<button onclick="clearRecords()">清空记录</button>
</div>
</body>
</html>